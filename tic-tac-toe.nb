(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     33040,        815]
NotebookOptionsPosition[     31651,        783]
NotebookOutlinePosition[     32088,        800]
CellTagsIndexPosition[     32045,        797]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\:041a\:0440\:0435\:0441\:0442\:0438\:043a\:0438-\:043d\:043e\:043b\
\:0438\:043a\:0438", "Title",
 CellChangeTimes->{{3.960281792401615*^9, 
  3.960281804379101*^9}},ExpressionUUID->"5397b522-cd5a-4ca7-9b24-\
0620907cccbb"],

Cell[CellGroupData[{

Cell["\:0411\:0435\:0439\:0437\:0435\:0440\:043e\:0432 \:041c\:0430\:043a\
\:0441\:0438\:043c\[LineSeparator]\:0411\:043e\:0447\:043a\:0430\:0440\:0435\
\:0432 \:0418\:0432\:0430\:043d\[LineSeparator]\:0422\:0440\:0443\:0445\:0430\
\:043d \:0415\:043b\:0438\:0437\:0430\:0432\:0435\:0442\:0430", \
"Subsubsection",
 CellChangeTimes->{{3.960281816435137*^9, 3.960281840598834*^9}},
 TextAlignment->Right,ExpressionUUID->"1e8dbc5f-a8e8-40f3-91a0-7a23b0ac01bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.960287383242134*^9, 3.960287417913669*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"21e705e1-5c60-4301-85cc-dc73575bbbbe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nolik", "=", "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thickness", "[", "0.05", "]"}], ",", 
      RowBox[{"Lighter", "[", 
       RowBox[{"Orange", ",", ".4"}], "]"}], ",", 
      RowBox[{"Circle", "[", "]"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"krestik", "=", "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thickness", "[", "0.05", "]"}], ",", 
      RowBox[{"Lighter", "[", 
       RowBox[{"Blue", ",", ".4"}], "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.5"}], ",", 
           RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", 
           RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.960387069107172*^9, 3.9603872457567043`*^9}, {
   3.960387293651001*^9, 3.96038732235034*^9}, {3.960387816458166*^9, 
   3.960387839551056*^9}, {3.9603878969435787`*^9, 3.9603879854800835`*^9}, 
   3.9603880327824764`*^9},
 CellLabel->
  "In[190]:=",ExpressionUUID->"962b0c65-e6f3-5748-af01-650ae662116b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"center", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"width", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"range", " ", "=", " ", 
   RowBox[{"center", " ", "+", " ", 
    RowBox[{"scale", " ", "*", "width"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scale", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"scalelist", " ", "=", " ", 
      RowBox[{"{", "}"}]}], " ", ",", 
     RowBox[{"delta", " ", "=", " ", "0."}], ",", 
     RowBox[{"speed", " ", "=", " ", "1"}], ",", 
     RowBox[{"draglist", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"dx", " ", "=", " ", "0"}], ",", " ", 
     RowBox[{"dy", " ", "=", " ", "0"}], ",", 
     RowBox[{"kr", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"nol", " ", "=", " ", 
      RowBox[{"{", "}"}]}], " ", ",", 
     RowBox[{"currentMove", " ", "=", " ", "True"}], ",", 
     RowBox[{"minlimx", " ", "=", " ", 
      RowBox[{"-", "4"}]}], ",", " ", 
     RowBox[{"maxlimx", " ", "=", "4"}], ",", 
     RowBox[{"minlimy", " ", "=", " ", 
      RowBox[{"-", "4"}]}], ",", " ", 
     RowBox[{"maxlimy", " ", "=", "4"}]}], "}"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"EventHandler", "[", 
    RowBox[{
     RowBox[{"Dynamic", "@", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"LightGray", ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}], "/.", 
              " ", 
              RowBox[{"None", " ", "->", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"scale", "*", 
                  RowBox[{"range", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
                 "2"}], ")"}]}]}], "]"}], "-", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0.5"}], "}"}]}], "]"}], ",", 
          RowBox[{"Darker", "[", "Gray", "]"}], ",", " ", "Thick", ",", " ", 
          RowBox[{"a", " ", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"InfiniteLine", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "+", "0.5"}], ",", "0.5"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], " ", "/@", 
              " ", 
              RowBox[{"Range", "[", 
               RowBox[{"minlimx", ",", "maxlimx"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"InfiniteLine", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", 
                   RowBox[{"#", "+", "0.5"}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "&"}], " ", "/@", 
              " ", 
              RowBox[{"Range", "[", 
               RowBox[{"minlimy", ",", "maxlimy"}], "]"}]}]}], "}"}]}], ",", 
          "kr", ",", " ", "nol"}], "}"}], ",", 
        RowBox[{"PlotRange", "->", " ", 
         RowBox[{"(", 
          RowBox[{"center", "+", 
           RowBox[{"scale", "*", "width"}]}], ")"}]}], ",", " ", 
        RowBox[{"Background", "->", " ", "White"}]}], "]"}]}], ",", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"ContainsAny", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{"kr", ",", "nol"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Round", "[", 
                RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}], 
                "]"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{"currentMove", ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"kr", ",", 
                RowBox[{"Inset", "[", 
                 RowBox[{"krestik", ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0.7", ",", "0.7"}], "}"}]}], "]"}]}], "]"}], ";", 
              " ", 
              RowBox[{"currentMove", " ", "=", " ", 
               RowBox[{"!", "currentMove"}]}]}], " ", ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"nol", ",", 
                RowBox[{"Inset", "[", 
                 RowBox[{"nolik", ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}], 
                   "]"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0.7", ",", "0.7"}], "}"}]}], "]"}]}], "]"}], ";", 
              " ", 
              RowBox[{"currentMove", " ", "=", " ", 
               RowBox[{"!", "currentMove"}]}]}]}], "]"}]}], " ", "]"}], 
         ")"}]}], ",", 
       RowBox[{"\"\<MouseDragged\>\"", " ", "\[RuleDelayed]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"draglist", ",", " ", 
            RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}]}], "]"}], 
          ";", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dx", ",", "dy"}], "}"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"draglist", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "-", 
            RowBox[{"draglist", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
          RowBox[{"center", "-=", 
           FractionBox[
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"dx", ",", "dx"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"dy", ",", "dy"}], "}"}]}], "}"}], "scale"]}]}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<MouseUp\>\"", " ", ":>", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"draglist", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"minlimx", ",", " ", "maxlimx"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"minlimy", ",", " ", "maxlimy"}], "}"}]}], "}"}], " ", "=",
            " ", 
           RowBox[{
            RowBox[{"Round", "[", "center", "]"}], "+", " ", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"scale", "*", "width"}], "]"}]}]}]}], ")"}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<MouseUp\>\"", ",", "2"}], "}"}], " ", ":>", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"scalelist", "=", 
           RowBox[{"{", "}"}]}], ";", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"minlimx", ",", " ", "maxlimx"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"minlimy", ",", " ", "maxlimy"}], "}"}]}], "}"}], " ", "=",
            " ", 
           RowBox[{
            RowBox[{"Round", "[", "center", "]"}], "+", " ", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"scale", "*", "width"}], "]"}]}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<MouseDragged\>\"", ",", "2"}], "}"}], " ", "\[RuleDelayed]",
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"scalelist", ",", " ", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", "*", 
              RowBox[{
               RowBox[{"MousePosition", "[", "\"\<CellScaled\>\"", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}], ";", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "scalelist", "]"}], " ", ">", " ", "1"}], 
            ",", 
            RowBox[{
             RowBox[{"delta", " ", "=", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"scalelist", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], "-", 
                RowBox[{"scalelist", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "2"}], "]"}], "]"}]}], ")"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"speed", " ", "=", 
              RowBox[{"3", "-", 
               RowBox[{"2", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "10"}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"scalelist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"scalelist", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ")"}], "2"]}], 
                 "]"}]}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"scale", " ", "=", " ", 
           RowBox[{"Clip", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"0.015", "*", "speed"}]}], ")"}], "*", 
               RowBox[{"Boole", "[", 
                RowBox[{"delta", ">", "0"}], "]"}], "*", "scale"}], " ", "+", 
              "  ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"0.015", "*", "speed"}]}], ")"}], "*", 
               RowBox[{"Boole", "[", 
                RowBox[{"delta", "<", "0"}], "]"}], "*", "scale"}], " ", "+", 
              " ", 
              RowBox[{"scale", "*", 
               RowBox[{"Boole", "[", 
                RowBox[{"delta", " ", "==", " ", "0."}], "]"}]}]}], ",", " ", 
             
             RowBox[{"{", 
              RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";"}], " ", 
         "\[IndentingNewLine]", " ", ")"}]}]}], "}"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9603698899937687`*^9, 3.960369901366081*^9}, {
   3.9603847094390697`*^9, 3.9603847481482677`*^9}, {3.9603849999500675`*^9, 
   3.960385052077091*^9}, {3.96038508345277*^9, 3.9603850899997864`*^9}, {
   3.9603852265933113`*^9, 3.960385239707985*^9}, {3.9603853032768154`*^9, 
   3.9603853841829414`*^9}, {3.9603858231954613`*^9, 
   3.9603858653378506`*^9}, {3.9603859028418274`*^9, 3.960385903826195*^9}, {
   3.9603859385493603`*^9, 3.960385968522833*^9}, {3.9603860219164696`*^9, 
   3.960386024525795*^9}, {3.9603860555722313`*^9, 3.960386168193552*^9}, {
   3.960386218320305*^9, 3.9603862991821213`*^9}, {3.9603864218674126`*^9, 
   3.9603864226330185`*^9}, {3.9603865017202015`*^9, 3.960386506251293*^9}, {
   3.960386553581703*^9, 3.9603867926942215`*^9}, {3.960386913289076*^9, 
   3.9603869475109787`*^9}, {3.960387011879156*^9, 3.960387015238411*^9}, {
   3.9603880696236763`*^9, 3.9603881625059433`*^9}, {3.960388265803232*^9, 
   3.9603882667404995`*^9}, {3.960388481363325*^9, 3.960388564272087*^9}, {
   3.9603886013881836`*^9, 3.9603887204983177`*^9}, {3.960388797929514*^9, 
   3.960388850450941*^9}, {3.960388990577135*^9, 3.960388998121893*^9}, {
   3.9603890698717575`*^9, 3.9603891017495823`*^9}, {3.960389134958935*^9, 
   3.9603891462242393`*^9}, {3.9603891780054455`*^9, 
   3.9603891785539627`*^9}, {3.9603892366526947`*^9, 
   3.9603892830068817`*^9}, {3.9603893352621956`*^9, 3.960389393181612*^9}, {
   3.9603894307522964`*^9, 3.960389439393572*^9}, {3.9603894726154976`*^9, 
   3.9603894835106487`*^9}, {3.960389521574419*^9, 3.960389620205368*^9}, {
   3.960392538183304*^9, 3.960392645872549*^9}, {3.960392689730175*^9, 
   3.9603926935425644`*^9}, {3.960392992261425*^9, 3.9603931540183277`*^9}, {
   3.960393193814581*^9, 3.960393266852564*^9}, {3.960393391282173*^9, 
   3.960393423999794*^9}, {3.9603934773573456`*^9, 3.96039348280937*^9}, {
   3.960393553313545*^9, 3.96039357524699*^9}, {3.96039361204809*^9, 
   3.960393654819046*^9}, {3.9603937188718452`*^9, 3.9603937307340717`*^9}, {
   3.9603937634534626`*^9, 3.9603938035051594`*^9}, {3.960393839700617*^9, 
   3.9603938596052437`*^9}, {3.9603938974262543`*^9, 
   3.9603938988760033`*^9}, {3.9603940325207977`*^9, 
   3.9603940728426266`*^9}, {3.960394116004778*^9, 3.9603941201837654`*^9}, {
   3.960394188472807*^9, 3.960394260796009*^9}, {3.960394295104746*^9, 
   3.9603943810195847`*^9}, {3.9603944691618633`*^9, 3.960394489062868*^9}, {
   3.9603945596824894`*^9, 3.960394585937151*^9}, {3.9603946790375156`*^9, 
   3.960394683069401*^9}, {3.960394732886757*^9, 3.960394774806116*^9}, {
   3.9603948168792915`*^9, 3.960394847913248*^9}, {3.960394885278345*^9, 
   3.9603948992649517`*^9}, {3.960394930233984*^9, 3.9603949438478985`*^9}, {
   3.960395009686102*^9, 3.960395151335726*^9}, {3.960395185860956*^9, 
   3.960395243325714*^9}, {3.9603952766746464`*^9, 3.960395333711788*^9}, {
   3.960395369016865*^9, 3.960395399227783*^9}, {3.9603954378628197`*^9, 
   3.9603955522055607`*^9}, {3.960395646696457*^9, 3.960395655214958*^9}, {
   3.9603956873925896`*^9, 3.9603957320677986`*^9}, {3.96039582926803*^9, 
   3.960395852462261*^9}, 3.960395892425083*^9, {3.9603960681128445`*^9, 
   3.9603960808621387`*^9}, 3.960396112144758*^9, {3.9603961555966053`*^9, 
   3.960396157424118*^9}, {3.9603962034724426`*^9, 3.960396204245249*^9}, {
   3.960396328636511*^9, 3.9603963802793007`*^9}, {3.9603964488965893`*^9, 
   3.960396458025959*^9}, {3.9603965149264393`*^9, 3.9603965163819504`*^9}, 
   3.9603966411336937`*^9, {3.9603967150228767`*^9, 3.96039671552174*^9}, {
   3.9603967605265503`*^9, 3.960396779485899*^9}, {3.9603968186509247`*^9, 
   3.960396819890709*^9}, {3.9603969297580338`*^9, 3.9603971601978607`*^9}, {
   3.9603972097965736`*^9, 3.960397297522852*^9}, {3.96039740205822*^9, 
   3.9603974336465225`*^9}, {3.960397475658745*^9, 3.9603975190743046`*^9}, {
   3.960397550536873*^9, 3.9603975543279934`*^9}, {3.9603975938702736`*^9, 
   3.9603976228353977`*^9}, {3.960397685134737*^9, 3.960397687273388*^9}, {
   3.9603977197434654`*^9, 3.9603977207724304`*^9}, {3.960397763670458*^9, 
   3.960397793310257*^9}, {3.960397835737484*^9, 3.960397851766577*^9}, {
   3.960397937725237*^9, 3.960397976083111*^9}, {3.9603981543206406`*^9, 
   3.9603981594173813`*^9}, {3.9603981945595703`*^9, 3.960398199737156*^9}, {
   3.96039827656382*^9, 3.9603983418332806`*^9}, {3.9603983963484287`*^9, 
   3.9603984163052025`*^9}, {3.960398459607874*^9, 3.96039846995767*^9}, {
   3.960398551650898*^9, 3.9603985798039303`*^9}, {3.960398612238716*^9, 
   3.9603986861524963`*^9}, {3.9603987206258183`*^9, 3.960398793231676*^9}, {
   3.960398851583021*^9, 3.9603988531377735`*^9}, 3.9603989080747223`*^9},
 CellLabel->
  "In[784]:=",ExpressionUUID->"57a6a2bc-3b0b-3b45-b5cc-e79935ae9b3f"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`scalelist$$ = {}, $CellContext`delta$$ = 
  0.04051121292500581, $CellContext`speed$$ = 
  2.8505140557245046`, $CellContext`draglist$$ = {}, $CellContext`dx$$ = 
  0., $CellContext`dy$$ = 0., $CellContext`kr$$ = {
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {16, 21}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {14, 21}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {15, 21}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {13, 22}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {16, 20}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {15, 20}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {14, 19}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {12, 19}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {16, 22}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {11, 20}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {12, 22}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {10, 19}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {12, 18}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {15, 18}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {17, 20}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {11, 22}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[0.4, 0.4, 1.], 
      Line[{{0.5, 0.5}, {-0.5, -0.5}}], 
      Line[{{-0.5, 0.5}, {0.5, -0.5}}]}], {9, 20}, {0, 0}, {0.7, 
    0.7}]}, $CellContext`nol$$ = {
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {14, 20}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {13, 21}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {14, 22}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {12, 21}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {13, 19}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {13, 20}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {12, 20}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {15, 22}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {11, 19}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {11, 21}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {10, 20}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {10, 18}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {13, 18}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {15, 19}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {17, 22}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {10, 21}, {0, 0}, {0.7, 0.7}], 
   Inset[
    Graphics[{
      Thickness[0.05], 
      RGBColor[1., 0.7, 0.4], 
      Circle[{0, 0}]}], {9, 19}, {0, 0}, {0.7, 
    0.7}]}, $CellContext`currentMove$$ = True, $CellContext`minlimx$$ = 
  7, $CellContext`maxlimx$$ = 19, $CellContext`minlimy$$ = 
  11, $CellContext`maxlimy$$ = 23}, 
  TagBox[
   DynamicBox[ToBoxes[
     Graphics[{LightGray, 
       Rectangle[Round[
          ReplaceAll[
           MousePosition["Graphics"], 
           None -> $CellContext`scale Part[$CellContext`range, All, 2] + 
            2]] - {0.5, 0.5}], 
       Darker[Gray], Thick, $CellContext`a = {
         Map[InfiniteLine[{# + 0.5, 0.5}, {0, 1}]& , 
          Range[$CellContext`minlimx$$, $CellContext`maxlimx$$]], 
         Map[InfiniteLine[{0.5, # + 0.5}, {1, 0}]& , 
          
          Range[$CellContext`minlimy$$, $CellContext`maxlimy$$]]}, \
$CellContext`kr$$, $CellContext`nol$$}, 
      PlotRange -> $CellContext`center + $CellContext`scale \
$CellContext`width, Background -> White], StandardForm],
    ImageSizeCache->{
     396.00000000000006`, {194.84743643933905`, 201.1525635606609}}],
   EventHandlerTag[{"MouseClicked" :> If[
       Not[
        ContainsAny[
         Part[
          Join[$CellContext`kr$$, $CellContext`nol$$], All, 2], {
          Round[
           MousePosition["Graphics"]]}]], 
       If[$CellContext`currentMove$$, AppendTo[$CellContext`kr$$, 
          Inset[$CellContext`krestik, 
           Round[
            MousePosition["Graphics"]], {0, 0}, {0.7, 
           0.7}]]; $CellContext`currentMove$$ = 
         Not[$CellContext`currentMove$$], AppendTo[$CellContext`nol$$, 
          Inset[$CellContext`nolik, 
           Round[
            MousePosition["Graphics"]], {0, 0}, {0.7, 
           0.7}]]; $CellContext`currentMove$$ = 
         Not[$CellContext`currentMove$$]]], 
     "MouseDragged" :> (AppendTo[$CellContext`draglist$$, 
        MousePosition["Graphics"]]; {$CellContext`dx$$, $CellContext`dy$$} = 
       Part[$CellContext`draglist$$, -1] - Part[$CellContext`draglist$$, 1]; 
      SubtractFrom[$CellContext`center, {{$CellContext`dx$$, \
$CellContext`dx$$}, {$CellContext`dy$$, \
$CellContext`dy$$}}/$CellContext`scale]), 
     "MouseUp" :> ($CellContext`draglist$$ = {}; {{$CellContext`minlimx$$, \
$CellContext`maxlimx$$}, {$CellContext`minlimy$$, $CellContext`maxlimy$$}} = 
       Round[$CellContext`center] + 
        Ceiling[$CellContext`scale $CellContext`width]), {
      "MouseUp", 
       2} :> ($CellContext`scalelist$$ = {}; {{$CellContext`minlimx$$, \
$CellContext`maxlimx$$}, {$CellContext`minlimy$$, $CellContext`maxlimy$$}} = 
       Round[$CellContext`center] + 
        Ceiling[$CellContext`scale $CellContext`width]), {
      "MouseDragged", 2} :> (AppendTo[$CellContext`scalelist$$, -1 + 2 Part[
           MousePosition["CellScaled"], 2]]; 
      If[Length[$CellContext`scalelist$$] > 
        1, $CellContext`delta$$ = 
         Part[$CellContext`scalelist$$, -1] - 
          Part[$CellContext`scalelist$$, -2]; $CellContext`speed$$ = 
         3 - 2 Exp[(-10) (Part[$CellContext`scalelist$$, -1] - 
              Part[$CellContext`scalelist$$, 1])^2]]; $CellContext`scale = 
       Clip[(1 + 0.015 $CellContext`speed$$) 
          Boole[$CellContext`delta$$ > 0] $CellContext`scale + (1 - 
           0.015 $CellContext`speed$$) 
          Boole[$CellContext`delta$$ < 
            0] $CellContext`scale + $CellContext`scale 
          Boole[$CellContext`delta$$ == 0.], {1, 3}]; Null), Method -> 
     "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{
  3.960395553031515*^9, {3.960395708444845*^9, 3.960395733449419*^9}, {
   3.960395834676277*^9, 3.9603958534322796`*^9}, {3.9603960891283073`*^9, 
   3.9603961125456467`*^9}, {3.960396184805361*^9, 3.9603962047228355`*^9}, 
   3.9603962730118523`*^9, {3.960396330690737*^9, 3.9603963623427258`*^9}, 
   3.9603964591917896`*^9, {3.9603965026693306`*^9, 3.9603965168592873`*^9}, 
   3.9603966422434196`*^9, 3.9603967163980846`*^9, {3.9603967622924366`*^9, 
   3.9603967802098675`*^9}, 3.9603968210425014`*^9, 3.9603969959724045`*^9, 
   3.9603970406770763`*^9, {3.9603970924852257`*^9, 3.960397110665331*^9}, 
   3.9603971607372055`*^9, {3.960397240190399*^9, 3.960397256673235*^9}, {
   3.96039729919759*^9, 3.960397319486767*^9}, 3.9603973734495716`*^9, {
   3.960397404158512*^9, 3.9603974340919456`*^9}, {3.960397479999893*^9, 
   3.9603975195570297`*^9}, 3.96039755555361*^9, 3.960397648672611*^9, 
   3.960397689317951*^9, 3.9603977222552147`*^9, 3.9603977998326855`*^9, 
   3.9603978528300266`*^9, 3.9603979143900375`*^9, 3.960397976960516*^9, 
   3.9603980607921753`*^9, 3.9603981598307343`*^9, 3.960398200766527*^9, {
   3.960398334164179*^9, 3.960398342563875*^9}, 3.9603984195779705`*^9, {
   3.9603984628420296`*^9, 3.9603984706822567`*^9}, 3.9603985815236835`*^9, 
   3.9603986353136654`*^9, 3.96039868711285*^9, {3.9603987253286533`*^9, 
   3.960398766069296*^9}, 3.960398798139393*^9, 3.9603988544185066`*^9, 
   3.960398910437828*^9, 3.960399010790516*^9},
 CellLabel->
  "Out[788]=",ExpressionUUID->"2b4cd3d8-92cc-4549-b4ce-96da7c566de6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Dynamic", "@", 
  RowBox[{"(", 
   RowBox[{"scale", "*", "range"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "@", 
  RowBox[{"Length", "[", 
   RowBox[{"a", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.960398161525612*^9, 3.9603981774524517`*^9}, {
  3.9603984746637783`*^9, 3.9603985042567787`*^9}},
 CellLabel->
  "In[737]:=",ExpressionUUID->"e53f914a-3932-6f45-8553-4a14ef421a08"],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`scale $CellContext`range, StandardForm],
  ImageSizeCache->{
   296.65518436431887`, {2.646337961219251, 9.251709231175482}}]], "Output",
 CellChangeTimes->{{3.960398164880148*^9, 3.9603981781868534`*^9}, {
  3.960398483496172*^9, 3.960398504645195*^9}},
 CellLabel->
  "Out[737]=",ExpressionUUID->"1365c972-d9ee-c14b-8a65-f11bae9446e3"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   Length[
    Part[$CellContext`a, 1]], StandardForm],
  ImageSizeCache->{
   15.724414443969726`, {0.12568359710276056`, 9.251709231175482}}]], "Output",\

 CellChangeTimes->{{3.960398164880148*^9, 3.9603981781868534`*^9}, {
  3.960398483496172*^9, 3.96039850465234*^9}},
 CellLabel->
  "Out[738]=",ExpressionUUID->"6d5fd571-0edd-1f40-b358-e0f5ad43dc91"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9603984725223064`*^9, 
  3.9603984732515545`*^9}},ExpressionUUID->"fbabe180-96c6-724c-a336-\
4f9f312172d2"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{574.8, 604.8},
WindowMargins->{{-4.8, Automatic}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"67122100-f723-4d51-aeaf-3452bb653a01"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 230, 4, 106, "Title",ExpressionUUID->"5397b522-cd5a-4ca7-9b24-0620907cccbb"],
Cell[CellGroupData[{
Cell[831, 30, 458, 6, 103, "Subsubsection",ExpressionUUID->"1e8dbc5f-a8e8-40f3-91a0-7a23b0ac01bd"],
Cell[1292, 38, 272, 6, 31, "Input",ExpressionUUID->"21e705e1-5c60-4301-85cc-dc73575bbbbe"],
Cell[1567, 46, 1540, 42, 156, "Input",ExpressionUUID->"962b0c65-e6f3-5748-af01-650ae662116b"],
Cell[CellGroupData[{
Cell[3132, 92, 16090, 356, 1245, "Input",ExpressionUUID->"57a6a2bc-3b0b-3b45-b5cc-e79935ae9b3f"],
Cell[19225, 450, 10950, 286, 414, "Output",ExpressionUUID->"2b4cd3d8-92cc-4549-b4ce-96da7c566de6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30212, 741, 459, 11, 51, "Input",ExpressionUUID->"e53f914a-3932-6f45-8553-4a14ef421a08"],
Cell[30674, 754, 384, 7, 35, "Output",ExpressionUUID->"1365c972-d9ee-c14b-8a65-f11bae9446e3"],
Cell[31061, 763, 391, 10, 35, "Output",ExpressionUUID->"6d5fd571-0edd-1f40-b358-e0f5ad43dc91"]
}, Open  ]],
Cell[31467, 776, 156, 3, 31, "Input",ExpressionUUID->"fbabe180-96c6-724c-a336-4f9f312172d2"]
}, Open  ]]
}, Open  ]]
}
]
*)

