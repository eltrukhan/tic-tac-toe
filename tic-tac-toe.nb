(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     31190,        753]
NotebookOptionsPosition[     30271,        727]
NotebookOutlinePosition[     30741,        745]
CellTagsIndexPosition[     30698,        742]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\:041a\:0440\:0435\:0441\:0442\:0438\:043a\:0438-\:043d\:043e\:043b\
\:0438\:043a\:0438", "Title",
 CellChangeTimes->{{3.960281792401615*^9, 
  3.960281804379101*^9}},ExpressionUUID->"5397b522-cd5a-4ca7-9b24-\
0620907cccbb"],

Cell[CellGroupData[{

Cell["\:0411\:0435\:0439\:0437\:0435\:0440\:043e\:0432 \:041c\:0430\:043a\
\:0441\:0438\:043c\[LineSeparator]\:0411\:043e\:0447\:043a\:0430\:0440\:0435\
\:0432 \:0418\:0432\:0430\:043d\[LineSeparator]\:0422\:0440\:0443\:0445\:0430\
\:043d \:0415\:043b\:0438\:0437\:0430\:0432\:0435\:0442\:0430", \
"Subsubsection",
 CellChangeTimes->{{3.960281816435137*^9, 3.960281840598834*^9}},
 TextAlignment->Right,ExpressionUUID->"1e8dbc5f-a8e8-40f3-91a0-7a23b0ac01bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nolik", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Lighter", "[", 
       RowBox[{"Orange", ",", ".4"}], "]"}], ",", 
      RowBox[{"Circle", "[", 
       RowBox[{"#", ",", "0.35"}], "]"}]}], "}"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"krestik", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Lighter", "[", 
       RowBox[{"Blue", ",", ".4"}], "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "+", 
          RowBox[{"{", 
           RowBox[{"0.35", ",", "0.35"}], "}"}]}], ",", 
         RowBox[{"#", "+", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.35"}], ",", 
            RowBox[{"-", "0.35"}]}], "}"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "+", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.35"}], ",", "0.35"}], "}"}]}], ",", 
         RowBox[{"#", "+", 
          RowBox[{"{", 
           RowBox[{"0.35", ",", 
            RowBox[{"-", "0.35"}]}], "}"}]}]}], "}"}], "]"}]}], "}"}], 
    "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mask1", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1", ",", "5"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mask2", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", "mask1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mask3", " ", "=", " ", 
    RowBox[{"Reverse", "[", "mask2", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "UpdateScale", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UpdateScale", "[", 
   RowBox[{"speed_", ",", "delta_"}], "]"}], " ", ":=", " ", 
  RowBox[{"(", 
   RowBox[{"scale", " ", "=", " ", 
    RowBox[{"Clip", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"0.015", "*", "speed"}]}], ")"}], "*", 
        RowBox[{"Boole", "[", 
         RowBox[{"delta", ">", "0"}], "]"}], "*", "scale"}], " ", "+", "  ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"0.015", "*", "speed"}]}], ")"}], "*", 
        RowBox[{"Boole", "[", 
         RowBox[{"delta", "<", "0"}], "]"}], "*", "scale"}], " ", "+", " ", 
       RowBox[{"scale", "*", 
        RowBox[{"Boole", "[", 
         RowBox[{"delta", " ", "==", " ", "0."}], "]"}]}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ")"}]}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "UpdateSpeed", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UpdateSpeed", "[", "scalelist_", "]"}], " ", ":=", 
  RowBox[{"(", 
   RowBox[{"speed", " ", "=", 
    RowBox[{"3", "-", 
     RowBox[{"2", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "10"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"scalelist", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "-", 
            RowBox[{"scalelist", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ")"}], "2"]}], 
       "]"}]}]}]}], ")"}]}], "\n", 
 RowBox[{"ClearAll", "[", "UpdateDelta", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UpdateDelta", "[", "scalelist_", "]"}], ":=", 
  RowBox[{"delta", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"scalelist", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "-", 
     RowBox[{"scalelist", "[", 
      RowBox[{"[", 
       RowBox[{"-", "2"}], "]"}], "]"}]}], ")"}]}]}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "UpdateScalelist", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UpdateScalelist", "[", "mousepos_", "]"}], " ", ":=", " ", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"scalelist", ",", " ", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", "*", 
      RowBox[{"mousepos", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "UpdateLims", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UpdateLims", "[", 
   RowBox[{"center_", ",", " ", "scale_", ",", " ", "width_"}], "]"}], ":=", 
  " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"minlimx", ",", " ", "maxlimx"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"minlimy", ",", " ", "maxlimy"}], "}"}]}], "}"}], " ", "=", 
    " ", 
    RowBox[{
     RowBox[{"Round", "[", "center", "]"}], "+", " ", 
     RowBox[{"3", " ", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"scale", "*", "width"}], "]"}]}]}]}], ")"}]}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "UpdateDraglist", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UpdateDraglist", "[", "mousepos_", "]"}], " ", ":=", " ", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"draglist", ",", " ", "mousepos"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "CalculateCenter", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CalculateCenter", "[", 
   RowBox[{"draglist_", ",", " ", "scale_"}], "]"}], " ", ":=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dx", ",", "dy"}], "}"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"draglist", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "-", 
      RowBox[{"draglist", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
    RowBox[{"center", "-=", 
     FractionBox[
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dx", ",", "dx"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"dy", ",", "dy"}], "}"}]}], "}"}], "scale"]}]}], ")"}]}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "MakeAMove", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeAMove", "[", "mousepos_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ContainsAny", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"kr", ",", "nol"}], "]"}], ",", 
       RowBox[{"{", "mousepos", "}"}]}], "]"}]}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"currentMove", " ", "==", " ", "1"}], ",", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"kr", ",", "mousepos"}], "]"}], ";", " ", 
       RowBox[{"currentMove", " ", "*=", " ", 
        RowBox[{"-", "1"}]}]}], " ", ",", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"nol", ",", "mousepos"}], "]"}], ";", " ", 
       RowBox[{"currentMove", " ", "*=", " ", 
        RowBox[{"-", "1"}]}]}]}], "]"}]}], " ", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "DrawLines", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DrawLines", "[", 
   RowBox[{
   "minlimx_", ",", " ", "maxlimx_", ",", " ", "minlimy_", ",", " ", 
    "maxlimy_"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"InfiniteLine", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "+", "0.5"}], ",", "0.5"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], " ", "/@", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"minlimx", ",", "maxlimx"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"InfiniteLine", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"#", "+", "0.5"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "&"}], " ", "/@", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"minlimy", ",", "maxlimy"}], "]"}]}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "HighlightRectangle", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HighlightRectangle", "[", "mousepos_", "]"}], ":=", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"mousepos", "/.", " ", 
       RowBox[{"None", " ", "->", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"scale", "*", 
           RowBox[{"range", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", "2"}], 
         ")"}]}]}], "]"}], "-", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "0.5"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "KrestikiWin", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KrestikiWin", "[", "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<\:041a\:0440\:0435\:0441\:0442\:0438\:043a\:0438 \
\:043f\:043e\:0431\:0435\:0434\:0438\:043b\:0438!\>\"", "]"}], ";", 
     RowBox[{"ClearField", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "NolikiWin", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NolikiWin", "[", "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<\:041d\:043e\:043b\:0438\:043a\:0438 \:043f\:043e\
\:0431\:0435\:0434\:0438\:043b\:0438!\>\"", "]"}], ";", 
     RowBox[{"ClearField", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "DetermineVictory", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DetermineVictory", "[", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"$res", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ListConvolve", "[", 
         RowBox[{
          RowBox[{"{", "mask1", "}"}], ",", "gamefield"}], "]"}], ",", 
        RowBox[{"ListConvolve", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", "mask1", "}"}], "]"}], ",", "gamefield"}], "]"}], ",", 
        RowBox[{"ListConvolve", "[", 
         RowBox[{"mask2", ",", "gamefield"}], "]"}], ",", 
        RowBox[{"ListConvolve", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", "mask2", "]"}], ",", " ", "gamefield"}], 
         "]"}]}], "}"}]}], "}"}], ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{"$res", ",", " ", "5", ",", "3"}], "]"}], ",", " ", 
      RowBox[{"KrestikiWin", "[", "]"}], ",", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"$res", ",", 
          RowBox[{"-", "5"}], ",", "3"}], "]"}], ",", " ", 
        RowBox[{"NolikiWin", "[", "]"}]}], "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "CheckPos", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CheckPos", "[", " ", "pos_", "]"}], " ", ":=", " ", 
   RowBox[{"And", "@@", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "#", "]"}], "<=", 
        FractionBox[
         RowBox[{" ", 
          RowBox[{
           RowBox[{"Length", "[", "gamefield", "]"}], "-", "1"}]}], "2"]}], 
       "&"}], "[", "pos", "]"}], "]"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "UpdateFieldInside", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpdateFieldInside", "[", " ", 
    RowBox[{"pos_", ",", " ", "currentMove_"}], "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{"gamefield", ",", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"pos", "-", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], 
             RowBox[{"(", 
              FractionBox[
               RowBox[{
                RowBox[{"Length", "[", "gamefield", "]"}], "-", "1"}], "2"], 
              ")"}]}]}], "]"}], "+", "1"}], ")"}], "]"}], "->", " ", 
       "currentMove"}]}], " ", "]"}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "UpdateField", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpdateField", "[", " ", 
    RowBox[{"pos_", ",", " ", "currentMove_"}], "]"}], " ", ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"CheckPos", "[", "pos", "]"}], ",", 
     RowBox[{"gamefield", "=", " ", 
      RowBox[{"UpdateFieldInside", "[", 
       RowBox[{"pos", ",", " ", "currentMove"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"gamefield", " ", "=", " ", 
       RowBox[{"ArrayPad", "[", 
        RowBox[{"gamefield", ",", "1"}], "]"}]}], ";", " ", 
      RowBox[{"UpdateField", "[", 
       RowBox[{"pos", ",", " ", "currentMove"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "ClearField", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearField", "[", "]"}], " ", ":=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"gamefield", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "5"}], "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"kr", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";", " ", 
    RowBox[{"nol", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";", " ", 
    RowBox[{"currentMove", " ", "=", " ", "1"}], ";"}], ")"}]}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9606183622631416`*^9, 3.960618415877882*^9}, {
   3.9606243599967823`*^9, 3.9606243625284595`*^9}, {3.960624416114599*^9, 
   3.960624457381935*^9}, {3.960624700183569*^9, 3.960624701292488*^9}, {
   3.960624744952036*^9, 3.960624850372799*^9}, {3.9606249350336227`*^9, 
   3.960624949979933*^9}, {3.960625017993147*^9, 3.9606250653338966`*^9}, {
   3.9606251191200333`*^9, 3.960625151435787*^9}, 3.960627667233572*^9, {
   3.96063213178636*^9, 3.9606321336608887`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[1247]:=",ExpressionUUID->"08e0cc99-3cdc-ac47-934b-14c8f387f278"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gamefield", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"kr", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"nol", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"currentMove", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scale", " ", "=", " ", "1"}], ";", 
  RowBox[{"speed", " ", "=", " ", "1"}], ";", 
  RowBox[{"scalelist", " ", "=", " ", 
   RowBox[{"{", "}"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delta", " ", "=", " ", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scalelist", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"draglist", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"minlimx", " ", "=", " ", 
   RowBox[{"-", "4"}]}], ";", 
  RowBox[{"maxlimx", " ", "=", "4"}], ";", 
  RowBox[{"minlimy", " ", "=", " ", 
   RowBox[{"-", "4"}]}], ";", 
  RowBox[{"maxlimy", " ", "=", "4"}], ";", 
  RowBox[{"dx", " ", "=", " ", "0"}], ";", " ", 
  RowBox[{"dy", " ", "=", " ", "0"}], ";", 
  RowBox[{"center", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"width", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"range", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"EventHandler", "[", 
    RowBox[{
     RowBox[{"Dynamic", "@", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"LightGray", ",", 
          RowBox[{"HighlightRectangle", "[", 
           RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}], "]"}], ",", 
          RowBox[{"Darker", "[", "Gray", "]"}], ",", " ", "Thick", ",", 
          RowBox[{"DrawLines", "[", 
           RowBox[{
           "minlimx", ",", "maxlimx", ",", "minlimy", ",", " ", "maxlimy"}], 
           "]"}], " ", ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
          RowBox[{"krestik", "/@", "kr"}], ",", " ", 
          RowBox[{"nolik", "/@", "nol"}]}], "}"}], ",", 
        RowBox[{"PlotRange", "->", " ", 
         RowBox[{"(", 
          RowBox[{"center", "+", 
           RowBox[{"scale", "*", "width"}]}], ")"}]}], ",", " ", 
        RowBox[{"Background", "->", " ", "White"}]}], "]"}]}], ",", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mousepos", " ", "=", " ", 
           RowBox[{"Round", "[", 
            RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}], "]"}]}], 
          ";", 
          RowBox[{"MakeAMove", "[", "mousepos", "]"}], ";", " ", 
          RowBox[{"UpdateField", "[", 
           RowBox[{"mousepos", ",", " ", 
            RowBox[{"-", "currentMove"}]}], "]"}], ";", " ", 
          RowBox[{"DetermineVictory", "[", "]"}]}], ")"}]}], ",", 
       RowBox[{"\"\<MouseDragged\>\"", " ", "\[RuleDelayed]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"UpdateDraglist", "[", 
           RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}], "]"}], ";", 
          RowBox[{"CalculateCenter", "[", 
           RowBox[{"draglist", ",", " ", "scale"}], "]"}]}], " ", ")"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"\"\<MouseUp\>\"", " ", ":>", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"draglist", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"UpdateLims", "[", 
           RowBox[{"center", ",", "scale", ",", "width"}], "]"}]}], ")"}]}], ",",
        " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<MouseUp\>\"", ",", "2"}], "}"}], " ", ":>", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"scalelist", "=", 
           RowBox[{"{", "}"}]}], ";", 
          RowBox[{"UpdateLims", "[", 
           RowBox[{"center", ",", " ", "scale", ",", " ", "width"}], "]"}]}], 
         ")"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<MouseDragged\>\"", ",", "2"}], "}"}], " ", "\[RuleDelayed]",
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"UpdateScalelist", "[", 
           RowBox[{"MousePosition", "[", "\"\<CellScaled\>\"", "]"}], "]"}], ";",
           " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "scalelist", "]"}], " ", ">", " ", "1"}], 
            ",", 
            RowBox[{
             RowBox[{"UpdateDelta", "[", "scalelist", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"UpdateSpeed", "[", "scalelist", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"UpdateScale", "[", 
           RowBox[{"speed", ",", "delta"}], "]"}]}], "\[IndentingNewLine]", 
         " ", ")"}]}]}], "}"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9603698899937687`*^9, 3.960369901366081*^9}, {
   3.9603847094390697`*^9, 3.9603847481482677`*^9}, {3.9603849999500675`*^9, 
   3.960385052077091*^9}, {3.96038508345277*^9, 3.9603850899997864`*^9}, {
   3.9603852265933113`*^9, 3.960385239707985*^9}, {3.9603853032768154`*^9, 
   3.9603853841829414`*^9}, {3.9603858231954613`*^9, 
   3.9603858653378506`*^9}, {3.9603859028418274`*^9, 3.960385903826195*^9}, {
   3.9603859385493603`*^9, 3.960385968522833*^9}, {3.9603860219164696`*^9, 
   3.960386024525795*^9}, {3.9603860555722313`*^9, 3.960386168193552*^9}, {
   3.960386218320305*^9, 3.9603862991821213`*^9}, {3.9603864218674126`*^9, 
   3.9603864226330185`*^9}, {3.9603865017202015`*^9, 3.960386506251293*^9}, {
   3.960386553581703*^9, 3.9603867926942215`*^9}, {3.960386913289076*^9, 
   3.9603869475109787`*^9}, {3.960387011879156*^9, 3.960387015238411*^9}, {
   3.9603880696236763`*^9, 3.9603881625059433`*^9}, {3.960388265803232*^9, 
   3.9603882667404995`*^9}, {3.960388481363325*^9, 3.960388564272087*^9}, {
   3.9603886013881836`*^9, 3.9603887204983177`*^9}, {3.960388797929514*^9, 
   3.960388850450941*^9}, {3.960388990577135*^9, 3.960388998121893*^9}, {
   3.9603890698717575`*^9, 3.9603891017495823`*^9}, {3.960389134958935*^9, 
   3.9603891462242393`*^9}, {3.9603891780054455`*^9, 
   3.9603891785539627`*^9}, {3.9603892366526947`*^9, 
   3.9603892830068817`*^9}, {3.9603893352621956`*^9, 3.960389393181612*^9}, {
   3.9603894307522964`*^9, 3.960389439393572*^9}, {3.9603894726154976`*^9, 
   3.9603894835106487`*^9}, {3.960389521574419*^9, 3.960389620205368*^9}, {
   3.960392538183304*^9, 3.960392645872549*^9}, {3.960392689730175*^9, 
   3.9603926935425644`*^9}, {3.960392992261425*^9, 3.9603931540183277`*^9}, {
   3.960393193814581*^9, 3.960393266852564*^9}, {3.960393391282173*^9, 
   3.960393423999794*^9}, {3.9603934773573456`*^9, 3.96039348280937*^9}, {
   3.960393553313545*^9, 3.96039357524699*^9}, {3.96039361204809*^9, 
   3.960393654819046*^9}, {3.9603937188718452`*^9, 3.9603937307340717`*^9}, {
   3.9603937634534626`*^9, 3.9603938035051594`*^9}, {3.960393839700617*^9, 
   3.9603938596052437`*^9}, {3.9603938974262543`*^9, 
   3.9603938988760033`*^9}, {3.9603940325207977`*^9, 
   3.9603940728426266`*^9}, {3.960394116004778*^9, 3.9603941201837654`*^9}, {
   3.960394188472807*^9, 3.960394260796009*^9}, {3.960394295104746*^9, 
   3.9603943810195847`*^9}, {3.9603944691618633`*^9, 3.960394489062868*^9}, {
   3.9603945596824894`*^9, 3.960394585937151*^9}, {3.9603946790375156`*^9, 
   3.960394683069401*^9}, {3.960394732886757*^9, 3.960394774806116*^9}, {
   3.9603948168792915`*^9, 3.960394847913248*^9}, {3.960394885278345*^9, 
   3.9603948992649517`*^9}, {3.960394930233984*^9, 3.9603949438478985`*^9}, {
   3.960395009686102*^9, 3.960395151335726*^9}, {3.960395185860956*^9, 
   3.960395243325714*^9}, {3.9603952766746464`*^9, 3.960395333711788*^9}, {
   3.960395369016865*^9, 3.960395399227783*^9}, {3.9603954378628197`*^9, 
   3.9603955522055607`*^9}, {3.960395646696457*^9, 3.960395655214958*^9}, {
   3.9603956873925896`*^9, 3.9603957320677986`*^9}, {3.96039582926803*^9, 
   3.960395852462261*^9}, 3.960395892425083*^9, {3.9603960681128445`*^9, 
   3.9603960808621387`*^9}, 3.960396112144758*^9, {3.9603961555966053`*^9, 
   3.960396157424118*^9}, {3.9603962034724426`*^9, 3.960396204245249*^9}, {
   3.960396328636511*^9, 3.9603963802793007`*^9}, {3.9603964488965893`*^9, 
   3.960396458025959*^9}, {3.9603965149264393`*^9, 3.9603965163819504`*^9}, 
   3.9603966411336937`*^9, {3.9603967150228767`*^9, 3.96039671552174*^9}, {
   3.9603967605265503`*^9, 3.960396779485899*^9}, {3.9603968186509247`*^9, 
   3.960396819890709*^9}, {3.9603969297580338`*^9, 3.9603971601978607`*^9}, {
   3.9603972097965736`*^9, 3.960397297522852*^9}, {3.96039740205822*^9, 
   3.9603974336465225`*^9}, {3.960397475658745*^9, 3.9603975190743046`*^9}, {
   3.960397550536873*^9, 3.9603975543279934`*^9}, {3.9603975938702736`*^9, 
   3.9603976228353977`*^9}, {3.960397685134737*^9, 3.960397687273388*^9}, {
   3.9603977197434654`*^9, 3.9603977207724304`*^9}, {3.960397763670458*^9, 
   3.960397793310257*^9}, {3.960397835737484*^9, 3.960397851766577*^9}, {
   3.960397937725237*^9, 3.960397976083111*^9}, {3.9603981543206406`*^9, 
   3.9603981594173813`*^9}, {3.9603981945595703`*^9, 3.960398199737156*^9}, {
   3.96039827656382*^9, 3.9603983418332806`*^9}, {3.9603983963484287`*^9, 
   3.9603984163052025`*^9}, {3.960398459607874*^9, 3.96039846995767*^9}, {
   3.960398551650898*^9, 3.9603985798039303`*^9}, {3.960398612238716*^9, 
   3.9603986861524963`*^9}, {3.9603987206258183`*^9, 3.960398793231676*^9}, {
   3.960398851583021*^9, 3.9603988531377735`*^9}, 3.9603989080747223`*^9, {
   3.960456700263874*^9, 3.9604567733258743`*^9}, {3.960457043430361*^9, 
   3.9604570744906178`*^9}, {3.960457126593424*^9, 3.9604571381529293`*^9}, {
   3.960617571176895*^9, 3.9606176226595364`*^9}, {3.960617694984865*^9, 
   3.960617718659321*^9}, {3.9606182795506573`*^9, 3.960618309451725*^9}, {
   3.960618824155361*^9, 3.9606188344519424`*^9}, {3.9606189516557903`*^9, 
   3.9606189602507496`*^9}, {3.960624470617403*^9, 3.9606245261510887`*^9}, {
   3.9606245581254025`*^9, 3.9606245936698647`*^9}, {3.9606246363332825`*^9, 
   3.9606246673168144`*^9}, {3.960624710323496*^9, 3.9606247114640903`*^9}, {
   3.960624891260788*^9, 3.960624925719631*^9}, {3.9606274333692017`*^9, 
   3.9606274704064636`*^9}, 3.9606275127654076`*^9, {3.960627578391775*^9, 
   3.9606276018792744`*^9}, {3.9606276833781147`*^9, 
   3.9606276865342712`*^9}, {3.96062786901766*^9, 3.9606278806888447`*^9}, {
   3.9606279608380756`*^9, 3.960628026714815*^9}, {3.960628067105734*^9, 
   3.9606281093908463`*^9}, {3.960628153030031*^9, 3.960628154983103*^9}, {
   3.960628358552593*^9, 3.9606284306724873`*^9}, {3.9606285091469955`*^9, 
   3.960628571497492*^9}, {3.9606309563449116`*^9, 3.9606309962316074`*^9}, {
   3.960631027418213*^9, 3.960631030513344*^9}, {3.960631151405918*^9, 
   3.960631155817835*^9}, {3.960631277285738*^9, 3.9606313749081326`*^9}, {
   3.9606314278619576`*^9, 3.960631521451889*^9}, 3.9606315523218365`*^9, {
   3.9606316066943073`*^9, 3.9606316229080772`*^9}, {3.9606316770308857`*^9, 
   3.9606316842491913`*^9}, 3.960631739559187*^9, {3.960631775476017*^9, 
   3.9606317800458317`*^9}, 3.96063184115757*^9, {3.9606318960659714`*^9, 
   3.960631939926914*^9}, {3.960632003031002*^9, 3.960632023970701*^9}, {
   3.9606320933748646`*^9, 3.960632097359129*^9}, {3.9606322411135063`*^9, 
   3.960632274505289*^9}},
 CellLabel->
  "In[1315]:=",ExpressionUUID->"634b64bd-dd6f-e94b-a1c6-87b5275934b6"],

Cell[BoxData[
 DynamicModuleBox[{}, 
  TagBox[
   DynamicBox[ToBoxes[
     Graphics[{LightGray, 
       $CellContext`HighlightRectangle[
        MousePosition["Graphics"]], 
       Darker[Gray], Thick, 
       $CellContext`DrawLines[$CellContext`minlimx, $CellContext`maxlimx, \
$CellContext`minlimy, $CellContext`maxlimy], 
       AbsoluteThickness[2], 
       Map[$CellContext`krestik, $CellContext`kr], 
       Map[$CellContext`nolik, $CellContext`nol]}, 
      PlotRange -> $CellContext`center + $CellContext`scale \
$CellContext`width, Background -> White], StandardForm],
    ImageSizeCache->{
     396.00000000000006`, {194.8474364393391, 201.15256356066095`}}],
   EventHandlerTag[{"MouseClicked" :> ($CellContext`mousepos = Round[
         MousePosition[
         "Graphics"]]; $CellContext`MakeAMove[$CellContext`mousepos]; \
$CellContext`UpdateField[$CellContext`mousepos, -$CellContext`currentMove]; \
$CellContext`DetermineVictory[]), 
     "MouseDragged" :> ($CellContext`UpdateDraglist[
        MousePosition[
        "Graphics"]]; $CellContext`CalculateCenter[$CellContext`draglist, \
$CellContext`scale]), 
     "MouseUp" :> ($CellContext`draglist = {}; \
$CellContext`UpdateLims[$CellContext`center, $CellContext`scale, \
$CellContext`width]), {
      "MouseUp", 
       2} :> ($CellContext`scalelist = {}; \
$CellContext`UpdateLims[$CellContext`center, $CellContext`scale, \
$CellContext`width]), {"MouseDragged", 2} :> ($CellContext`UpdateScalelist[
        MousePosition["CellScaled"]]; 
      If[Length[$CellContext`scalelist] > 
        1, $CellContext`UpdateDelta[$CellContext`scalelist]; \
$CellContext`UpdateSpeed[$CellContext`scalelist]]; \
$CellContext`UpdateScale[$CellContext`speed, $CellContext`delta]), Method -> 
     "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{{3.9606284023311005`*^9, 3.960628431078705*^9}, {
   3.9606285100906315`*^9, 3.960628529977831*^9}, 3.960628572075609*^9, 
   3.9606302762132053`*^9, 3.9606309643521347`*^9, 3.9606311711482277`*^9, 
   3.960631428565071*^9, 3.96063168548353*^9, {3.960631784623825*^9, 
   3.9606318099579906`*^9}, {3.960631914643076*^9, 3.960631940379711*^9}, 
   3.9606320132197514`*^9, 3.960632099046547*^9, 3.960632137431204*^9, {
   3.9606322791459618`*^9, 3.96063230441922*^9}},
 CellLabel->
  "Out[1320]=",ExpressionUUID->"2e87725d-3f82-df4a-abd5-b3cab0da9ac3"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1152, 615.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
Magnification:>1.1 Inherited,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"67122100-f723-4d51-aeaf-3452bb653a01"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 230, 4, 106, "Title",ExpressionUUID->"5397b522-cd5a-4ca7-9b24-0620907cccbb"],
Cell[CellGroupData[{
Cell[831, 30, 458, 6, 103, "Subsubsection",ExpressionUUID->"1e8dbc5f-a8e8-40f3-91a0-7a23b0ac01bd"],
Cell[1292, 38, 14289, 395, 1389, "Input",ExpressionUUID->"08e0cc99-3cdc-ac47-934b-14c8f387f278"],
Cell[CellGroupData[{
Cell[15606, 437, 12195, 235, 617, "Input",ExpressionUUID->"634b64bd-dd6f-e94b-a1c6-87b5275934b6"],
Cell[27804, 674, 2427, 48, 430, "Output",ExpressionUUID->"2e87725d-3f82-df4a-abd5-b3cab0da9ac3"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

